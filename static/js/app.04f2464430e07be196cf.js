webpackJsonp([1],{105:function(e,t){},106:function(e,t){},107:function(e,t){},108:function(e,t){},109:function(e,t){},110:function(e,t){},116:function(e,t,n){n(106);var r=n(4)(n(36),null,null,null);e.exports=r.exports},117:function(e,t,n){n(110);var r=n(4)(n(39),n(125),null,null);e.exports=r.exports},118:function(e,t,n){n(108);var r=n(4)(n(40),n(123),null,null);e.exports=r.exports},119:function(e,t,n){n(105);var r=n(4)(n(41),n(121),null,null);e.exports=r.exports},120:function(e,t,n){n(107);var r=n(4)(n(37),n(122),null,null);e.exports=r.exports},121:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[n("progress-bar",{attrs:{percent:e.currentProgressPercent}}),e._v(" "),n("div",{staticClass:"echo"},[e._l(e.numbers[0],function(e){return n("echo",{key:e.id,attrs:{text:e.value,"as-class":e.class}})}),n("span",{staticClass:"sign"},[e._v("×")]),e._l(e.numbers[1],function(e){return n("echo",{key:e.id,attrs:{text:e.value,"as-class":e.class}})}),n("span",{staticClass:"sign"},[e._v("=")]),e._l(e.numbers[2],function(e){return n("echo",{key:e.id,attrs:{text:e.value,"as-class":e.class}})})],2),e._v(" "),n("div",{staticClass:"keyboard"},[n("keyboard",{attrs:{layouts:"12345|67890",maxlength:2},on:{input:e.changed},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1),e._v(" "),n("b-modal",{ref:"myModalRef",staticClass:"clear",attrs:{"hide-footer":"","hide-header":"",centered:"",title:""}},[n("div",{staticClass:"d-block text-center"},[n("h3",[e._v(e._s(e.modalText))])]),e._v(" "),n("b-btn",{staticClass:"mt-3",attrs:{variant:"outline-secondary",block:""},on:{click:e.hideModal}},[e._v("Продолжить")])],1),e._v(" "),n("audio",{ref:"audioOk",attrs:{src:"./static/sounds/ok.wav"}}),e._v(" "),n("audio",{ref:"audioErr",attrs:{src:"./static/sounds/err.wav"}})],1)},staticRenderFns:[]}},122:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("aside",{staticClass:"vue-keyboard",class:{full:e.full,empty:e.empty,valid:e.valid,invalid:!e.valid},attrs:{role:"application","data-value":e.value,"data-layout":e.layout}},e._l(e.buttons,function(t){return n("div",{staticClass:"vue-keyboard-row",attrs:{role:"row","data-keys":t.length}},e._l(t,function(t){return n("button",{staticClass:"vue-keyboard-key",class:t.type,attrs:{role:"button","data-args":t.args,"data-text":t.value,"data-action":t.action.name},on:{click:function(e){e.preventDefault(),t.action.callable(e)}}},[e._v(e._s(t.value))])}))}))},staticRenderFns:[]}},123:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",[n("div",{attrs:{id:"progressBar"}},[n("div",{style:e.styleObject})])])},staticRenderFns:[]}},124:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app"},[n("div",{staticClass:"page"},[n("router-view",{attrs:{"increment-level":e.incrementLevel,"current-data":e.currentData,"set-data":e.setData}})],1)])},staticRenderFns:[]}},125:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("span",{class:e.asClass},[e._v(e._s(e.value))])])},staticRenderFns:[]}},28:function(e,t,n){"use strict";var r=n(7),a=n(126),s=n(119),o=n.n(s);r.a.use(a.a),t.a=new a.a({routes:[{path:"/",name:"home",component:o.a},{path:"/:session",name:"session",component:o.a,props:!0}]})},29:function(e,t,n){"use strict";var r=n(27),a=n(7),s=n(35);a.a.use(r.c),t.a=new r.c.Store({modules:{multi:s.a}})},31:function(e,t,n){n(109);var r=n(4)(n(38),n(124),null,null);e.exports=r.exports},34:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(30),a=n.n(r),s=n(7),o=n(33),u=(n.n(o),n(32)),i=n.n(u),l=n(31),c=n.n(l),d=n(28),v=n(29);n.i(o.sync)(v.a,d.a),s.a.config.productionTip=!1,s.a.use(i.a,{name:"ls",createComputed:!0}),new s.a({el:"#app",router:d.a,store:v.a,template:'<App :increment-level="incrementLevel" :current-data="currentData" :set-data="setData" />',components:{App:c.a},data:function(){return{currentLevel:0,stats:[].fill.call({length:10},0)}},watch:{currentLevel:function(e){this.$ls.set("currentLevel",e)},stats:function(e){for(var t=[],n=0;n<10;n++)t.push(e[n]||0);this.$ls.set("stats",t.join(","))}},created:function(){var e=this;e.currentLevel=Number(e.$ls.get("currentLevel",0));for(var t=e.$ls.get("stats","0,0,0,0,0,0,0,0,0,0").split(","),n=0;n<10;n++)e.stats[n]=t[n]},methods:{incrementLevel:function(){this.currentLevel++},setData:function(e){var t=this;a()(e).forEach(function(n){t[n]=e[n]})},currentData:function(){var e=this;return{currentLevel:e.currentLevel,stats:e.stats}}}})},35:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a={},s=o(t||.4,0,n);switch(console.log(t,"->",s),e.actualLevel=s,s){case 0:a.n1=1,a.n2=i(2,9,r);break;case 1:a.n1=2,a.n2=i(3,9,r);break;case 2:a.n1=i(2,9,r),a.n2=a.n1;break;case 3:a.n1=i(3,5,r);do{a.n2=i(3,9,r)}while(a.n1===a.n2);break;default:a.n1=i(6,9,r);do{a.n2=i(6,9,r)}while(a.n1===a.n2)}return l(a),a.n31=Math.floor(a.n1*a.n2/10)||"",a.n32=Math.floor(a.n1*a.n2-10*a.n31)||"0",a}function a(){var e=void 0,t=void 0,n=void 0,r=void 0,a=void 0;if(null!==p)e=p,p=null;else{do{t=2*Math.random()-1,n=2*Math.random()-1,r=t*t+n*n}while(0===r||r>=1);a=Math.sqrt(-2*Math.log(r)/r),e=t*a,p=n*a}return e/14}function s(e,t){var n=void 0;do{n=a()}while(n<e||n>t);return n}function o(e,t,n){var r=void 0,a=void 0,o=0;do{r=s(-1,1),r=r*Math.log(500/(1+e))+Math.log(e),a=Math.floor(Math.exp(r)+.5),o++}while(o<10&&(a<t||a>n));return a}function u(e,t){var n=e+Math.random()*(t+1-e);return n=Math.floor(n)}function i(e,t,n){for(var r=[],a=e;a<=t;a++)for(var s=1+(n[a]||-.1);s>0;s-=.1)r.push(a);return r[u(0,r.length-1)]}function l(e){if(Math.random()<.5){var t=void 0;t=e.n1,e.n1=e.n2,e.n2=t}return e}var c={numbers:[],complexity:0,position:[0,1],actualLevel:0,lastNumbers:{n1:0,n2:0}},d={generateTask:function(e){(0,e.commit)("generate_task",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{currentLevel:0,maxLevel:0,stats:[]})}},v={generate_task:function(e,t){for(var n=r(e,t.currentLevel,t.maxLevel,t.stats);n.n1===e.lastNumbers.n1&&n.n2===e.lastNumbers.n2||n.n1===e.lastNumbers.n2&&n.n2===e.lastNumbers.n1;)n=r(e,t.currentLevel,t.maxLevel,t.stats);console.log(n.n1,"x",n.n2),e.lastNumbers.n1=n.n1,e.lastNumbers.n2=n.n2;var a=[[{id:"n00",value:"",correctValue:"",class:"empty"},{id:"n11",value:n.n1+""||"",correctValue:"",class:null},{id:"n02",value:"",correctValue:"",class:"empty"}],[{id:"n10",value:"",correctValue:"",class:"empty"},{id:"n11",value:n.n2+""||"",correctValue:"",class:null},{id:"n12",value:"",correctValue:"",class:"empty"}],[{id:"n20",value:n.n31+""||"",correctValue:"",class:!n.n31&&"empty"||null},{id:"n21",value:n.n32+""||"",correctValue:"",class:!n.n32&&"empty"||null},{id:"n22",value:"",correctValue:"",class:"empty"}]],s=[Math.floor(Math.random()*a.length),1];s[1]=s[0]===a.length-1&&n.n31?Math.floor(2*Math.random()):1,a[s[0]][s[1]]={id:"n"+s[0]+s[1],value:"…",correctValue:n["n"+(s[0]>1?"3"+(s[1]+1):s[0]+1)]+""||"",class:"question"},e.numbers=a,e.complexity=(s[0]<2?1:1===s[1]?.7:.8)*(t.currentLevel>e.actualLevel?.7:t.currentLevel<e.actualLevel?1.5:1),e.position=s}},f={getNumbers:function(e){return e.numbers},getComplexity:function(e){return e.complexity},getPosition:function(e){return e.position}};t.a={state:c,actions:d,mutations:v,getters:f};var p=null},36:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46);t.default=r.a},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={PIPE:"7440011c983cf39ae730b1f831e2922ac5a76910",OPEN_BRACE:"f630c4abcae620278f82e142a526ef325c2a773a",CLOSE_BRACE:"ad982c66898e02a5dab419ea7568421b03f68ee2"};t.default={name:"keyboard",props:{value:{type:String,default:""},layouts:{type:[String,Array],required:!0},maxlength:{type:Number,default:0,validator:function(e){return e>=0}},pattern:{type:String,default:null}},data:function(){return{layout:0}},computed:{full:function(){return this.maxlength>0&&this.value.length>=this.maxlength},empty:function(){return 0===this.value.length},lines:function(){return(Array.isArray(this.layouts)?this.layouts:[this.layouts])[this.layout].replace("||",r.PIPE).replace("{{",r.OPEN_BRACE).replace("}}",r.CLOSE_BRACE).split("|")},buttons:function(){var e=this;return this.lines.map(function(t){var n=t.match(new RegExp("("+r.OPEN_BRACE+"|"+r.CLOSE_BRACE+"|"+r.PIPE+"|.)","g")),a=[],s=null;return n.forEach(function(t){if("{"===t)s="";else if("}"===t){var n=s.split(":"),o=n.length>1?n[0]:"",u=n.length>1?n[1]:n[0],i=n.length>2?n[2]:null,l=null;l=["append","backspace","space","clear","goto"].indexOf(u)>=0?e[u].bind(e,i):e.$emit.bind(e,u,e),a.push({type:"action",action:{name:u.replace(/\s+/g,"-").toLowerCase(),callable:l},value:o,args:i}),s=null}else null!==s?s+=t:(t===r.PIPE&&(t="|"),t===r.OPEN_BRACE&&(t="{"),t===r.CLOSE_BRACE&&(t="}"),a.push({type:"char",action:{name:null,callable:e.append.bind(e,t)},value:t,args:null}))}),a})},valid:function(){return!this.pattern||this.value.match(new RegExp(this.pattern))}},methods:{mutate:function(e){this.maxlength>0&&(e=e.slice(0,this.maxlength)),this.$emit("input",e)},append:function(e){this.mutate(this.value+e)},backspace:function(){this.mutate(this.value.slice(0,this.value.length-1))},space:function(){this.append(" ")},goto:function(e){if(!Array.isArray(this.layouts))throw new Error("A single non-array layout was provided.");if(!(e>=0&&e<this.layouts.length))throw new Error("The requested layout does not exist.");this.layout=e},clear:function(){this.mutate("")}}}},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app",props:{incrementLevel:{type:Function,required:!0},currentData:{type:Function,required:!0},setData:{type:Function,required:!0}}}},39:function(e,t,n){"use strict";function r(e,t,n){e!==t&&(e<t?e++:e<t?e--:e=t,n.value=""+e,setTimeout(function(){r(e,t,n)},25))}Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{asClass:{type:String,required:!1},text:{type:String,required:!0}},data:function(){return{value:""}},mounted:function(){this.value=this.text},watch:{text:function(e){var t=this,n=Number(t.value),a=Number(e);n&&a?r(n,a,t):t.value=e}}}},40:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{percent:{type:Number,required:!0}},data:function(){return{}},computed:{styleObject:function(){return{maxWidth:this.percent+"%",minWidth:this.percent+"%",width:this.percent+"%"}}}}},41:function(e,t,n){"use strict";function r(e){if(!e.session)return void d(e);var t=e.session.split(","),n=t.slice(0,-1).slice(1).map(function(e){return Number(e)}),r=Number(t[0]),s=t.slice(-1)[0],o=a(r+","+n);r>0&&r<=O&&10===n.length&&o===s?(console.log("Session get: Level -> "+r),e.progress=0,setTimeout(function(){e.setData({currentLevel:r,stats:n}),d(e)},50)):0===r&&10===n.length&&o===s?(console.log("Session get: Level and stats dropped"),e.progress=0,setTimeout(function(){e.setData({currentLevel:r,stats:n}),d(e)},50)):(console.log("Checksum failed, session ignored"),d(e))}function a(e){for(var t=""+h()(e),n=305419896,r=t.length,a=0;a<r;a++)n+=t.charCodeAt(a)*(a+1);return(4294967295&n).toString(16)}function s(e){for(var t=""+e.currentData().currentLevel,n=e.currentData().stats,r=0;r<10;r++)t+=","+(n[r]||"0");window.location.replace("#"+t+","+a(t))}function o(e,t){var n=["0","1","2","3","4","5","6","7","8","9","Backspace","Delete"],r=["Backspace","Delete"];if(n.includes(t)){var a=e.numbers[e.position[0]][e.position[1]];if(a.value&&a.correctValue&&a.value!==a.correctValue){if(r.includes(t))return a.value=C,void(a.class="question");u(e,t,a)}}}function u(e,t,n){var r=t===n.correctValue;n.value=t,n.class=r?"correct":"incorrect",e.$refs[r?"audioOk":"audioErr"].play(),r?i(e,n):l(e,n)}function i(e,t){var n=e.currentData().stats,r=Math.floor(10*(n[t.correctValue]-1/A))/10,a=(new Date).getTime()-e.startTime;n[t.correctValue]=r>0?r:0,e.tries++,e.errorState=!1,v(e,a),setTimeout(function(){e.errorsInSequence=e.errorsInSequence>1&&e.complexity<=1?1:0,e.startTime=(new Date).getTime(),d(e)},T)}function l(e,t){e.currentData().stats[t.correctValue]++,c(e,t),e.tries++,e.errors++,e.errorsInSequence++}function c(e,t){e.errorState=!0,setTimeout(function(){e.errorState&&(t.value=C,t.class="question",e.errorState=!1)},q)}function d(e){console.log("tries",e.tries,"errors",e.errors,Math.round(e.errors/(e.tries||1)*100)+"%"),e.generateTask({currentLevel:e.currentData().currentLevel,maxLevel:O,stats:e.currentData().stats})}function v(e,t){var n=e.errorsInSequence>0?0:t>=S?0:t<D?1+Math.round(D/t):1;e.progress+=Math.floor(n*e.complexity*10)/10,f(e),console.log(e.progress,e.currentData().currentLevel,n,e.complexity,Math.floor(t/D),e.errorsInSequence)}function f(e){var t=e.currentData().currentLevel,n=N[t].maxProgress;e.progress>n&&t<N.length-1&&(e.progress-=n,e.modalText="Следующий уровень! Поздравляем!",e.showModal(),e.incrementLevel(),s(e)),e.progress>n&&t<N.length&&(e.ended||(e.ended=!0,e.modalText="Пройти всю программу обучения за "+Math.round(((new Date).getTime()-e.started)/1e3/60+1)+" мин. это прекрасный результат!",e.showModal()),e.progress=n,s(e))}Object.defineProperty(t,"__esModule",{value:!0});var p=n(42),h=n.n(p),m=n(44),g=n.n(m),y=n(27),b=n(115),x=n.n(b),_=n(117),L=n.n(_),w=n(118),M=n.n(w),k=n(48),E=n(14),P=n(47),C="…",D=6e3,S=15e3,T=1e3,q=2e3,N=[{maxProgress:10},{maxProgress:20},{maxProgress:40},{maxProgress:80},{maxProgress:160}],O=N.length-1,R=N.reduce(function(e,t){return e+t.maxProgress},0),A=5;t.default={components:{Echo:L.a,Keyboard:x.a,ProgressBar:M.a,"b-modal":P.a,"b-btn":E.a},directives:{"b-modal":k.a},props:{session:{type:String},incrementLevel:{type:Function,required:!0},currentData:{type:Function,required:!0},setData:{type:Function,required:!0}},data:function(){return{input:"",progress:0,startTime:(new Date).getTime(),errorsInSequence:0,errorState:!1,started:(new Date).getTime(),tries:0,errors:0,modalText:"",ended:!1}},computed:g()({},n.i(y.a)({numbers:"getNumbers",complexity:"getComplexity",position:"getPosition"}),{currentProgressPercent:function(){var e=this,t=N.reduce(function(t,n,r){return t+(r<e.currentData().currentLevel?n.maxProgress:0)},0)+e.progress,n=Math.floor(t/R*100);return console.log(t,n,"%"),n}}),methods:g()({},n.i(y.b)(["generateTask"]),{changed:function(e){var t=this,n=e[e.length-1];this.input=n,o(t,n)},showModal:function(){this.$refs.myModalRef.show()},hideModal:function(){this.$refs.myModalRef.hide()}}),mounted:function(){var e=this;r(e),window.scrollTo(0,document.body.scrollHeight),window.addEventListener("keyup",function(t){o(e,t.key)})}}}},[34]);
//# sourceMappingURL=app.04f2464430e07be196cf.js.map